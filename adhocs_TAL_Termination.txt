//Vista

//Notes
  Copyright (c) 2003 by Yardi Systems
  NAME
    adhocs_TAL_Termination.txt
  DESCRIPTION

  NOTES
    Adhoc Report (SQL Server)
  MODIFIED
    08/05/2019 - Created by jonathan
    08/05/2019 - Last Modified by jonathan
//End Notes

//Database
FillDocs
//End Database

//Options
//End Options

//Title
TAL Termination of Assistance
//End Title

//LIST TAL_Termination
Y_TAL_Termination_Assistance.docx
HUD-5380.docx
//END LIST

//Select Primary
SELECT TOP 2 'TAL_Termination' _LIST_
            , GETDATE() 'LetterDate'
            , p.sCode 'PropCode'
            , unit.sCode 'UnitCode'
            , tenant.sCode 'TenCode'
            , RTrim(tenant.sFirstName) + ' ' + tenant.sLastName 'TenFirstLast'
            , case when isnull(tenant.saddr1, '') <> '' then ltrim(rtrim(tenant.saddr1)) + '^' else '' end + case when isnull(tenant.saddr2, '') <> '' then ltrim(rtrim(tenant.saddr2)) + '^' else '' end + case when isnull(tenant.sCity, '') <> '' then ltrim(rtrim(tenant.sCity)) else '' end + case when isnull(tenant.sState, '') = '' and isnull(tenant.sZipCode, '') = '' then ltrim(rtrim(tenant.sState)) + ' ' + ltrim(rtrim(tenant.SZIPCODE)) else ', ' + ltrim(rtrim(tenant.sState)) + ' ' + ltrim(rtrim(tenant.SZIPCODE)) end 'TenFullAddress'
            , REVIEW58VOUCH.dCR12p 'RentAmt'
            , Review58SUMM.dteffective2b 'Review58EffDate'
            ,ISNULL(Tenant_Landlord.Tenant_Landlord,-1) Tenant_Landlord
FROM  Property p  INNER JOIN Unit ON (p.hMy = unit.hProperty)
INNER JOIN Tenant ON (unit.hMy = tenant.hUnit)
INNER JOIN h8Summ Review58SUMM ON (tenant.hmyperson = Review58SUMM.htenant)  AND (ISNULL(Review58SUMM.bMasterRecd, 0) = 0)
LEFT JOIN h8Vouch Review58vouch ON (Review58SUMM.hMy = Review58vouch.hsum)
LEFT JOIN H8Unit H8U on H8U.hUnit = Unit.hMy
LEFT JOIN Person O on O.hMy = H8U.hVendorLtr
    LEFT JOIN (
          Select 0 Tenant_Landlord
          Union
          Select 1
        ) Tenant_Landlord on 1=1
                         AND 1= CASE
                                WHEN Tenant_Landlord.Tenant_Landlord=1 AND ISNULL(O.hmy,0)> 0 THEN 1
                                WHEN Tenant_Landlord.Tenant_Landlord=0 AND ISNULL(Tenant.hmyperson,0)> 0 THEN 1
                             ELSE 0
                             END
WHERE 1 = 1
AND p.itype = 3

 #conditions#
ORDER BY Review58EffDate Desc
// ORDER BY  CASE WHEN '#FillDate11#' = '01/01/1900' THEN GetDate() ELSE '#FillDate11#' END ASC
//End Select Primary

//Format
LetterMailDate MMMM DD, YYYY
LetterDate MMMM DD, YYYY
TenFullAddress Multiline
Review58EffDate MM/DD/YYYY
//End Format

//Filter
//Type, DataTyp,Name,           Caption,        Key,    List,                   Val1,             Val2, Mandatory,Multi-Type, Title
0    ,A    ,"FillDate11"    ,"Letter Mail Date"    ,  ,""    ,"",     ,N    ,   ,Y
C    ,T    ,"p.hMy"    ,"Property"    ,  ,"61"    ,"p.hMy = #p.hMy# "    ,     ,N    ,   ,Y
0    ,T    ,"Field110"    ,"Unit"    ,  ,"4"    ,"unit.sCode  IN  ('#Field110#') ",     ,N    ,   ,Y
0    ,T    ,"Field111"    ,"Tenant"    ,  ,"1"    ,"tenant.sCode  IN  ('#Field111#') ",     ,N    ,   ,Y
//End Filter
